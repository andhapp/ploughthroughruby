
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Plough => Ruby</title>
  <meta name="author" content="andHapp">

  
  <meta name="description" content="In this post, I will talk about a ruby method that I had no idea existed which might come handy in debugging your code.The method I am talking abou...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ploughthroughruby.co.uk//blog/page/3/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Plough => Ruby" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Plough => Ruby</a></h1>
  
    <h2>Journey through ruby</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ploughthroughruby.co.uk/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="http://www.andhapp.com/blog">General Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/17/an-interesting-ruby-method.html/">An Interesting Ruby Method</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-04-17T00:00:00+01:00" pubdate  data-updated="true" >Apr 17<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In this post, I will talk about a ruby method that I had no idea existed which might come handy in debugging your code.</p>

<p>The method I am talking about is <em>set_trace_func</em>. It&#8217;s part of the Kernel class and it does what it says. Allows one to set the method tracing on a method. The following snippet explains it further. Here, we have a class, TestingSetProcFunc:</p>

<pre>
    class TestingSetProcFunc
      def traceThisMethod
        source = 1
        target = 2
      end
    end
</pre>


<p>To inject set_trace_func in, it needs to be called before the method is invoked, like this:</p>

<pre>    
    puts "Event    File:Line                Id          Binding        Classname"
    set_trace_func proc { |event, file, line, id, binding, classname|
      printf "%8s %s:%-2d %20s %12s %8s\n", event, file, line, id, binding, classname
    }
</pre>


<p>It takes a proc with upto 6 arguments. These are the events with their brief descriptions:</p>

<ul>
<li>c-call (call a C-language routine)</li>
<li>c-return (return from a C-language routine)</li>
<li>call (call a Ruby method)</li>
<li>class (start a class or module definition)</li>
<li>end (finish a class or module definition)</li>
<li>line (execute code on a new line)</li>
<li>raise (raise an exception)</li>
<li>return (return from a Ruby method).</li>
</ul>


<p>Now, to run this we just need to call the method and look at the output:</p>

<pre>
    tracer = TestingSetProcFunc.new
    tracer.traceThisMethod
</pre>


<p>This is what the output will look like when you run it on the command line:</p>

<pre>    
Event    File:Line                Id          Binding        Classname
c-return test.rb:11       set_trace_func #<Binding:0x0b53c4>   Kernel
    line test.rb:13                      #<Binding:0x0b52fc>         
  c-call test.rb:13                  new #<Binding:0x0b525c>    Class
  c-call test.rb:13           initialize #<Binding:0x0b5144> BasicObject
c-return test.rb:13           initialize #<Binding:0x0b5090> BasicObject
c-return test.rb:13                  new #<Binding:0x0b4ff0>    Class
    line test.rb:14                      #<Binding:0x0b4f50>         
    call test.rb:2       traceThisMethod #<Binding:0x0b4eb0> TestingSetProcFunc
    line test.rb:3       traceThisMethod #<Binding:0x0b4dfc> TestingSetProcFunc
    line test.rb:4       traceThisMethod #<Binding:0x0b4d5c> TestingSetProcFunc
  return test.rb:5       traceThisMethod #<Binding:0x0b4cbc> TestingSetProcFunc    
</pre>


<p>This output gives one a good idea about the work that is happening in the background. The weird looking Binding instance is the context at that particular place in the code. I have just scratched the surface and I am sure there&#8217;s a lot one can do with this method. Have a look at the <a href="https://github.com/ruby/ruby/blob/trunk/test/ruby/test_settracefunc.rb">ruby&#8217;s test for set_trace_func</a> for more useful ways of employing it.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/03/12/ruby-hacking-guide-chapter-1.html/">Ruby Hacking Guide - Chapter 1</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-03-12T00:00:00+00:00" pubdate  data-updated="true" >Mar 12<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have completed proof-reading and testing the code from old Ruby Hacking Guide and re-releases in the wild again. It still needs some styling work but I will hopefully find time to sort that out this week.</p>

<p>In the meantime, have a <a href="http://rubyhacking.andhapp.co.uk/2011/01/30/chapter-1.html">read through</a> and see if you spot any mistakes.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/03/12/free-ruby-1.9-online-book.html/">Free Ruby 1.9 Online Book</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-03-12T00:00:00+00:00" pubdate  data-updated="true" >Mar 12<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Just found this nicely done online book on <a href="http://ruby.runpaint.org/">Ruby 1.9</a>, in particular. It&#8217;s a must see.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/01/21/ruby-file-append-mode.html/">Ruby File Append Mode</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-01-21T00:00:00+00:00" pubdate  data-updated="true" >Jan 21<span>st</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There are different file modes available to the developer when creating and opening new files in Ruby. One that I didn&#8217;t know about was &#8220;a&#8221; which basically means append to the end of the file rather than starting a new one. What could it be useful for? One example would be as a log file of some sort where one wants to preserve the old data and add new data to the end of the file. Very trivial but helpful if you know about these things. Just makes you a better developer.</p>

<p>A simple code example would be:</p>

<pre>
    file = File.new("datamapper.log", "a")  
</pre>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/01/17/ruby-hacking-guide.html/">Ruby Hacking Guide</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-01-17T00:00:00+00:00" pubdate  data-updated="true" >Jan 17<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I got hold of an out-of-date <a href="http://hawthorne-press.com/WebPage_RHG.html">Ruby Hacking Guide</a> and it looks very interesting. Therefore, in order to improve my understanding of Ruby internals, I have decided to spend time in reading it and the writing posts about it. The entire book can be downloaded in the form of HTML pages and might not make sense since some of it has been machine translated.</p>

<p>I hope my efforts are useful for anyone willing to venture into Ruby Internals.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/01/03/method-default-arguments-and-passing-nil-value.html/">Method Default Arguments and Passing Nil Value</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-01-03T00:00:00+00:00" pubdate  data-updated="true" >Jan 3<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is something very trivial and I kind of observed it whilst programming couple of weeks ago. For example, you had a method like this:</p>

<pre>
  class SomeClass
    def some_method(some_argument = '')
      raise ArgumentError unless some_argument
    end
  end
</pre>


<p>Now, I was under the impression that if I passed in a nil into this method, for some reason some_argument will still have the default value(&#8221;) as opposed to the nil value passed in but default arguments come into play when no value is passed in for the method arguments. But I was passing in nil which is an instance of NilClass and therefore some_argument gets assigned the nil value and an exception is raised.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/01/03/convert-array-to-hash-mystery.html/">Convert Array to Hash Mystery</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2011-01-03T00:00:00+00:00" pubdate  data-updated="true" >Jan 3<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It is always easy to find solutions on Google but the real fun is in finding out how a bit of code works. It just helps you understand much more about the language and how it behaves. Converting an array to hash is easy. Just use this piece of code that I found on google:</p>

<pre>
  some_array = [1,2,3]
  some_hash = Hash[*(some_array.collect{|v| [v,v]}.flatten)] # yields {1=>1, 2=>2, 3=>3}
</pre>


<p>Few people have asked the question behind this conversion and I just decided to break it apart and tackle it bit by bit. Our objective, again, is to convert an array to a hash. Hash&#8217;s ruby documenation tells us that a new Hash object can be created by using even number of arguments. Something similar to the following code:</p>

<pre>
  some_hash = Hash[1,1,2,2,3,3] # This creates a hash object similar to this {1=>1, 2=>2, 3=>3}
</pre>


<p>All we need to do now is convert our some_array (defined in the first code snippet) and convert it into [1,1,2,2,3,3].</p>

<p>It&#8217;s simple really. We take the some_array and convert it into an array&#8217;s or array like this:</p>

<pre>
  some_array = [1,2,3]
  some_array.collect{|v| [v, v]} # will yield [[1,1], [2,2], [3,3]]
</pre>


<p>Now to convert it into [1,1,2,2,3,3] we just need to flatten this array of arrays like this:</p>

<pre>
  some_array = [1,2,3]
  some_array.collect{|v| [v, v]}.flatten # will yield [1,1,2,2,3,3]
</pre>


<p>Now, all we need to do is use the splat (*) unary operator. The splat operator expands the supplied array into individual arguments which is what we need to convert array into a hash. You could also achieve the same with the following snippet:</p>

<pre>
  some_array = [1,2,3]
  some_hash = Hash[*(some_array+some_array).sort] # yields {1=>1, 2=>2, 3=>3}
</pre>


<p>I hope you can work that out yourself. I hope this little discussion helped you.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/07/06/paperclip-and-rescue.html/">Paperclip and Rescue</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-07-06T00:00:00+01:00" pubdate  data-updated="true" >Jul 6<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Reading Open Source Code is probably the best way of learning new ways. Paperclip is an amazing file upload tool by brilliant guys at Thoughtbot. And yesterday, while going through their code I realised that <strong>rescue</strong> can be used as a statement modifier. For example, consider this block of code below:</p>

<pre>
  type = (self.path.match(/\.(\w+)$/)[1] rescue "octet-stream").downcase
</pre>


<p>What do you think happens here?
Its quite simple really. If the first statement (the match bit) raises and exception the second statement is executed instead.</p>

<p>Another way to write this would be:</p>

<pre>
  begin
    type = (self.path.match(/\.(\w+)$/)[1]).downcase
  rescue
    "octet-stream"
  end
</pre>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/02/22/install-pg-and-mysql-gems.html/">Install Pg and Mysql Gems</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2010-02-22T00:00:00+00:00" pubdate  data-updated="true" >Feb 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is not entirely realted to ruby but if you ever program with ruby you will find yourself using pg and mysql gems and the issue is how exactly do I install them. This mini-post (rather tumble) is just to make a note of this. Run the following in Teerminal.</p>

<p>PostgreSql</p>

<pre>
  export PATH=/usr/local/pgsql/bin:${PATH}
  gem install pg
</pre>


<p>MySql</p>

<pre>
  export PATH=/usr/local/mysql/bin:${PATH}
  gem install mysql
</pre>


<p>Also, please note that you should have postgres and mysql installed on your machine.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/12/20/proc-proc-blocks.html/">Proc, Proc, Blocks</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2009-12-20T00:00:00+00:00" pubdate  data-updated="true" >Dec 20<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I know you must be thinking proc and Proc is the same thing and I must have mistyped. But, proc and Proc are different things. Blocks is a beautiful concept and you can achieve so much by using blocks carefully that it is unbelievable. I created a simple DSL using blocks and Faker gem to spit out XML used for testing purposes. I mean it took me few hours to do the first version up and running in Sinatra. Amazing.</p>

<p>So, block is nothing more than bits of code within curly brackets. The concept of blocks is used excessively throughout Ruby in iterators like inject, select, map, each and so on and so forth. For example:</p>

<pre>
def example_from_a_block
  puts "Should call a block"
  yield 
  puts "Yes, I did!"
end
</pre>


<p>and invoke it like:</p>

<pre>
example_from_a_block { puts "in a block" }
</pre>


<p>But blocks do have problems. Not exactly problems, but yeah shortcoming for sure. They are not objects. So&#8230;what difference does it make if they are not objects. I don&#8217;t care man. I like them. Exactly you like blocks but you would love blocks wrapped as objects. Yes, these things do exist. They are called proc or lambda. So what is a proc then? It is basically a block but with object like features, I mean you can manipulate them and pass them around like regular objects. Cool.</p>

<p>To create a proc, just do:</p>

<pre>
p = Proc.new { puts "I am a proc" }
</pre>


<p></p>

<p>It is absolutely essential to pass a block to a proc. &#8220;p&#8221; is basically an instance of the class <a href="http://ruby-doc.org/core/classes/Proc.html">Proc</a>. Run this in you irb session and confim that it is indeed an object with an object_id:</p>

<pre>
p.object_id
</pre>


<p>Hmm&#8230;two down one to go. What exactly is a proc then. proc is just a simple global method, if you will, of the Kernel module. So, you can just invoke it like this:</p>

<pre>
kernels_proc_variable = proc {|a| a + 10 }
</pre>


<p>Now, proc behaves differently in Ruby 1.8 and Ruby 1.9. In 1.8, it returns a lambda where as in 1.9 it is a synonym for Proc.new. So, please be aware of this simple yet pivotal difference. Pivotal because lambda&#8217;s and proc&#8217;s are slightly different, although on the surface they look the same. They are both instances of Proc so let us just say they are siblings. There is so much more you can do with Procs and this post has just touched the surface of it. I will discuss lambda and closures in the coming posts and then compare them.</p>
</div>
  
  


    </article>
  
  <nav class="pagination">
    <div>
      
        <a class="prev" href="/blog/page/4/">&larr; Older</a>
      
      <a href="/blog/archives">Blog Archives</a>
      
      <a class="next" href="/blog/page/2/">Newer &rarr;</a>
      
    </div>
  </nav>
</div>
<aside class="sidebar">
  
    <section>
  <h1>My Business</h1>
  <ul id="my_business">
      <li class="post">
        <a href="https://suggestion.io">Suggestion.io</a>
      </li>
      <li class="post">
        <a href="http://www.newstrapper.com">NewsTrapper</a>
      </li>
      <li class="post">
        <a href="http://andhapplimited.co.uk">Consultancy</a>
      </li>
  </ul>
</section>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2015/12/06/webpack-dev-server-and-rails.html/">Webpack dev server and Rails</a>
      </li>
    
      <li class="post">
        <a href="/2015/11/30/integrate-react-es6-webpack-babel-with-rails.html/">Integrate React, ES6, Webpack and Babel with Rails</a>
      </li>
    
      <li class="post">
        <a href="/2015/10/04/rebooting-an-old-gem.html/">Rebooting an old gem</a>
      </li>
    
      <li class="post">
        <a href="/2015/03/01/removing-a-method-in-ruby.html/">Removing a method in Ruby</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/25/ruby-command-line-flags.html/">Ruby command line flag for debugging</a>
      </li>
    
  </ul>
</section>

<!-- Begin MailChimp Signup Form -->
<div id="mc_embed_signup">
<form action="http://andhapp.us3.list-manage.com/subscribe/post?u=8f39182205ca41412cd1301ed&amp;id=4d157fe12d" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
	<label for="mce-EMAIL">For interesting articles, subscribe to our mailing list</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_8f39182205ca41412cd1301ed_4d157fe12d" value=""></div>
	<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
</form>
</div>
<!--End mc_embed_signup-->




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - andHapp -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-7379349-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>





</body>
</html>
